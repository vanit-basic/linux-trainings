<!Doctype html>
<html>
	<head>
		<title>Search</title>
		<meta charset='utf-8'>
	</head>
	<body>
	<script>
		let apiCall = async (api) => { 
		const apiRoot = 'https://679df325-6aaa-4981-af84-0065b07c8380.mock.pstmn.io';  
		const request = `${apiRoot}${api}`;  
		//console.log(request);  
		let response = await fetch(request);  
		let json = await response.json();
		for (let i = 0; i < json.length; i++)
		createElem(json[i]);
		console.log(json);
		return json;
		}
		function submitHandler(event)
		{
			event.preventDefault();
			validation();
	
		}
		document.body.onload = () => print();
		
		function print ()
		{
			let allCars = apiCall('/car');
			//for (let i = 0; i < cars.length; i++){
			//createElem(cars[i]);
			//}
		}
		function createElem(obj){
			const div= document.createElement('div');
			const p = document.createElement('p');
			p.innerHTML ="Car name: "+obj.name+"<br>Color: "+obj.color+"<br>Date of issue: "+obj.year+"<br> Vin: "+obj.vin;
			div.appendChild(p);
			document.getElementById('conteiner').appendChild(div);
			document.body.appendChild(document.getElementById('conteiner'));
			copy_page=document.body.innerHTML;
		}
	
	
		let copy_page=document.body.innerHTML;
	
	
		function createCars(name,color,year,vin)
		{
			let obj={
				name:name,
			    color:color,
			    year:year,
			    vin: vin
			}
		//cars.push(obj);
		createElem(obj);
		}
	
		function searchCar(inputID)
		{
			document.getElementById('conteiner').innerHTML=copy_page;
			let conteiner=document.getElementById('conteiner');
			let name=document.getElementById(inputID).value.trim();
			if(name==="")
			{
				document.body.innerHTML=copy_page;
			}
			else
			{
				let result = apiCall(`/car?color=${name}`);
				//let result = apiCall(`/car?vin=${name}`);
				//let result = apiCall(`/car?year=${name}`);
				//let result=cars.find(item=>item.name==name||item.color==name||item.year==name||item.vin==name);
				/*if(isEmpty(result))
				{
					conteiner.innerHTML=result.name+"<br>"+result.color+"<br>"+result.year+"<br>"+result.vin;
					document.body.appendChild(conteiner);
				}
				else
				{
					conteiner.innerHTML="Nothing found to display";
					document.body.appendChild(conteiner);
				}*/
		
			}
		}
		function isEmpty(obj) 
		{
			for(let key in obj)
			return true;
    
			return false;
		}
		function validation()
		{
			let nameCar=document.getElementById('carName').value.trim();
			let colorCar=document.getElementById('carColor').value.trim();
			let yearCar=document.getElementById('carYear').value.trim();
			let vinCar=document.getElementById('carVin').value.trim();

			if (nameCar && colorCar && yearCar && vinCar) 
			{
				createCars(nameCar, colorCar, yearCar, vinCar);
				return;
			}
			else{
				alert("Enter all fields");
				return;
				}
			}
				
	</script>
	<div>
	<label>Add new car</label><br>
	<form class="form_1" onsubmit="submitHandler(event)">
	<input type="text" id="carName" placeholder="Enter car name"/><br>
	<input type="text" id="carColor" placeholder="Enter car color"/><br>
	<input type="text" id="carYear" placeholder="Enter date of issue"/><br>
	<input type="text" id="carVin" placeholder="Enter vin"/><br>
	<input type="submit" id="btn" value="Add new car"/>
	<br>
	</form>
	</div>
	<label>Search cars</label><br>
	<input type="text" id="carValue" placeholder="Enter car name">
	<input type="submit" value="search" onclick="searchCar('carValue')"/>
	<div id="conteiner">
	</div>
		
	</body>
</html>