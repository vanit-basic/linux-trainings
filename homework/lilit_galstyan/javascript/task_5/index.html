<!DOCTYPE html>

<html>
	<head>
		<title> Cars </title>
		<meta charset = 'UTF-8'>
	</head>

	<body>
		<form onsubmit='submitHandler(event)' id="form">
			<label for="input1">Data</label><br>
			<input type="text" id="nameInput" name="name" placeholder="Enter any data for car" ><br>
                                      
			<label for="input2">Keywords</label><br>
			<input type="text" id="keywordInput" name="keyword" placeholder="Enter keyword for accident" ><br>


			<input  type="submit" value="ok">
                        <button onclick="replace()" >to create</button> 
			<div id="info"></div>
                        <div id="resultInfo">
				<p></p>
				
                                <li id="name">
					
					<li id="year"> </li>
			<!--		<li id="accident"> </li>
					<li id="color"> </li>
			<li id="vin"> </li>-->
					
				</li>
                                
                        </div>
		</form>

		<script src='datas.js'></script>
	        <script>

		document.body.onload = () => addInfo();
		function addInfo() {
		const div = document.createElement('div');

                let apiCall = async (api) => {
                const apiRoot = 'https://cd613c04-1e6d-4d04-b8ff-5530dd76bcd0.mock.pstmn.io/';
                const request = `${apiRoot}${api}`;
                console.log(request);
                let response = await fetch(request);
                let json = await response.json();
                return json;
                }
		let allCars = apiCall('/cars');	
		allCars.then((val) => {
                console.log(val);
		for(let i = 0; i < val.length;i++){
                const datas = document.createElement('p');    
                datas.innerHTML = Object.values(val[i]);
                div.appendChild(datas);
		document.getElementById('info').appendChild(div);
		}
		});
		}
               let dat = document.getElementById('nameInput').value;
               let word = document.getElementById('keywordInput').value;
               function submitHandler(event) {		       
	        event.preventDefault();
		searchByDatas(dat);
	        searchByAccident(word);
		remove();       
	        };
               function searchByDatas(data){
		  let result = "Sorry we dont have car with that data";     
                  for (let i = 0; i < carDatas.length; i++){
                  let values = Object.values(carDatas[i]);
			  if (values.includes(data) && data){
				  result = carDatas[i];
			  }
		    };
		const div = document.createElement('div');
		const datas = document.createElement('p');
		datas.innerHTML =Object.values(result);
		div.appendChild(datas);	
                document.getElementById('resultInfo').appendChild(div);
	        };
                function searchByAccident(keyword){
		let result = "Sorry we dont have car with story like that";
                for (let i = 0; i < carDatas.length; i++){
		if  (carDatas[i].accident.includes(keyword) && keyword){
				result = carDatas[i];
			}
		 
		  } ;
		const div = document.createElement('div');
		const accident = document.createElement('p');
		accident.innerHTML = Object.values(result);
		div.appendChild(accident);	
                document.getElementById('resultInfo').appendChild(div);
		};
                function remove(){
		let elem = document.getElementById('info');
		elem.parentNode.removeChild(elem);	
		};  
                function replace() {
			location.replace('./newindex.html');
		 }
		</script>
	</body>
</html>
